<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ğŸ“Š Ø­Ø§Ø³Ø¨Ø© Ø£Ø¨Ùˆ Ù†Ø¬Ø¯ Ù„Ù„ØªØ¯Ø§ÙˆÙ„</title>
<style>
  :root{
    --bg:#0e1220;
    --panel:#171c2f;
    --accent:#00e6d2;
    --text:#e9eef7;
    --muted:#9aa4b2;
    --danger:#ff5c7c;
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--text);font-family:Tahoma,Arial,sans-serif}
  .wrap{max-width:760px;margin:0 auto;padding:20px}
  h1{text-align:center;color:var(--accent);font-size:1.6rem;margin-bottom:20px}
  .card{background:var(--panel);padding:16px;border-radius:12px;margin-bottom:18px}
  label{display:block;font-weight:bold;margin-bottom:6px}
  input,select{width:100%;padding:10px;border-radius:8px;border:1px solid #2a314d;background:#0b1020;color:var(--text);font-size:15px}
  button{width:100%;padding:12px;margin-top:14px;border:0;border-radius:10px;background:var(--accent);color:#001a17;font-weight:bold;font-size:1rem;cursor:pointer}
  button:active{transform:scale(.97)}
  .res{line-height:1.9}
  .pill{display:inline-block;padding:.2rem .5rem;border-radius:999px;background:#0b1020;border:1px solid #2a314d;color:var(--muted);font-size:.8rem;margin-inline-start:.4rem}
  .grid-3{display:grid;grid-template-columns:1fr;gap:10px}
  @media (min-width:640px){.grid-3{grid-template-columns:repeat(3,1fr)}}
  .hint{font-size:.8rem;color:var(--muted);margin-top:4px}
  .err{color:var(--danger);font-weight:bold}
  .ok{color:#8ef3ff;font-weight:bold}
</style>
</head>
<body>
<div class="wrap">
  <h1>ğŸ“Š Ø­Ø§Ø³Ø¨Ø© Ø£Ø¨Ùˆ Ù†Ø¬Ø¯ Ù„Ù„ØªØ¯Ø§ÙˆÙ„</h1>

  <div class="card">
    <label>ğŸ’° Ø±Ø£Ø³ Ø§Ù„Ù…Ø§Ù„</label>
    <input id="capital" type="number" placeholder="Ù…Ø«Ø§Ù„: 800">

    <label>ğŸ“ˆ Ø§Ù„Ø±Ø§ÙØ¹Ø© (Leverage)</label>
    <input id="leverage" type="number" placeholder="Ù…Ø«Ø§Ù„: 20">

    <label>ğŸ’µ Ø³Ø¹Ø± Ø§Ù„Ø¯Ø®ÙˆÙ„</label>
    <input id="entryPrice" type="number" placeholder="Ù…Ø«Ø§Ù„: 2500">

    <label>ğŸ¯ Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ (Ø¨Ø§Ù„Ø¯ÙˆÙ„Ø§Ø±)</label>
    <input id="targetProfit" type="number" placeholder="Ù…Ø«Ø§Ù„: 50">

    <label>Ù†ÙˆØ¹ Ø§Ù„ØµÙÙ‚Ø©</label>
    <select id="positionType">
      <option value="long">Ù„ÙˆÙ†Ù‚ (Ø´Ø±Ø§Ø¡)</option>
      <option value="short">Ø´ÙˆØ±Øª (Ø¨ÙŠØ¹)</option>
    </select>

    <label>ğŸ§¾ Ø£Ù…Ø± Ø§Ù„Ø¯Ø®ÙˆÙ„</label>
    <select id="entrySide">
      <option value="taker">Ù…Ø§Ø±ÙƒØª (Taker)</option>
      <option value="maker">Ù„ÙŠÙ…ÙØª (Maker)</option>
    </select>

    <label>ğŸ§¾ Ø£Ù…Ø± Ø§Ù„Ø®Ø±ÙˆØ¬</label>
    <select id="exitSide">
      <option value="taker">Ù…Ø§Ø±ÙƒØª (Taker)</option>
      <option value="maker">Ù„ÙŠÙ…ÙØª (Maker)</option>
    </select>

    <label>Ù†Ø³Ø¨Ø© Ø±Ø³ÙˆÙ… Taker %</label>
    <input id="takerPct" type="number" step="0.001" value="0.05">

    <label>Ù†Ø³Ø¨Ø© Ø±Ø³ÙˆÙ… Maker %</label>
    <input id="makerPct" type="number" step="0.001" value="0.02">

    <label>Ø®ØµÙ… BNB (%)</label>
    <input id="bnbDiscount" type="number" value="10">

    <label>Funding Rate Ù„ÙƒÙ„ 8 Ø³Ø§Ø¹Ø§Øª (%)</label>
    <input id="fundingPct" type="number" step="0.001" value="0">

    <label>Ø¹Ø¯Ø¯ ÙØªØ±Ø§Øª Ø§Ù„ØªÙ…ÙˆÙŠÙ„</label>
    <input id="fundingPeriods" type="number" value="0">

    <button onclick="calc()">Ø§Ø­Ø³Ø¨ Ø§Ù„Ø¢Ù†</button>
  </div>

  <div class="card">
    <h3>Ø§Ù„Ù†ØªØ§Ø¦Ø¬</h3>
    <div id="out" class="res">â€”</div>
  </div>
</div>

<script>
function num(v){return Number(v)||0;}
function pctToRate(p){return p/100;}

function calc(){
  const capital=num(document.getElementById("capital").value);
  const leverage=num(document.getElementById("leverage").value);
  const entryPrice=num(document.getElementById("entryPrice").value);
  const targetProfit=num(document.getElementById("targetProfit").value);
  const posType=document.getElementById("positionType").value;
  const entrySide=document.getElementById("entrySide").value;
  const exitSide=document.getElementById("exitSide").value;
  const takerPct=num(document.getElementById("takerPct").value);
  const makerPct=num(document.getElementById("makerPct").value);
  const bnbDisc=num(document.getElementById("bnbDiscount").value);
  const fundingPct=num(document.getElementById("fundingPct").value);
  const fundingPeriods=num(document.getElementById("fundingPeriods").value);

  const notional=capital*leverage;
  const takerRate=pctToRate(takerPct)*(1-bnbDisc/100);
  const makerRate=pctToRate(makerPct)*(1-bnbDisc/100);
  const entryRate=(entrySide==="taker")?takerRate:makerRate;
  const exitRate=(exitSide==="taker")?takerRate:makerRate;

  const entryFee=notional*entryRate;
  const exitFee=notional*exitRate;
  const fundingFee=notional*pctToRate(fundingPct)*fundingPeriods;

  const totalFees=entryFee+exitFee+fundingFee;
  const requiredProfit=targetProfit+totalFees;
  const priceChangeRatio=requiredProfit/notional;

  let exitPrice;
  if(posType==="long"){
    exitPrice=entryPrice*(1+priceChangeRatio);
  }else{
    exitPrice=entryPrice*(1-priceChangeRatio);
  }

  const breakEven=(posType==="long")?entryPrice*(1+totalFees/notional):entryPrice*(1-totalFees/notional);

  document.getElementById("out").innerHTML=`
    <div class="grid-3">
      <div><span class="pill">Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø±ÙƒØ²</span><div class="ok">${notional.toFixed(2)} $</div></div>
      <div><span class="pill">Ø±Ø³ÙˆÙ… Ø§Ù„Ø¯Ø®ÙˆÙ„</span><div>${entryFee.toFixed(2)} $</div></div>
      <div><span class="pill">Ø±Ø³ÙˆÙ… Ø§Ù„Ø®Ø±ÙˆØ¬</span><div>${exitFee.toFixed(2)} $</div></div>
    </div>
    <div class="grid-3" style="margin-top:10px">
      <div><span class="pill">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±Ø³ÙˆÙ…</span><div>${totalFees.toFixed(2)} $</div></div>
      <div><span class="pill">Funding</span><div>${fundingFee.toFixed(2)} $</div></div>
      <div><span class="pill">Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨</span><div>${targetProfit.toFixed(2)} $</div></div>
    </div>
    <hr style="border:0;border-top:1px solid #2a314d;margin:14px 0">
    <div class="grid-3">
      <div><span class="pill">Ù†Ø³Ø¨Ø© Ø§Ù„ØªØºÙŠØ± Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©</span><div>${(priceChangeRatio*100).toFixed(4)} %</div></div>
      <div><span class="pill">Ø³Ø¹Ø± Ø§Ù„Ø®Ø±ÙˆØ¬ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨</span><div class="ok">${exitPrice.toFixed(2)}</div></div>
      <div><span class="pill">Ø³Ø¹Ø± Ø§Ù„ØªØ¹Ø§Ø¯Ù„</span><div>${breakEven.toFixed(2)}</div></div>
    </div>
  `;
}
</script>
</body>
</html>
